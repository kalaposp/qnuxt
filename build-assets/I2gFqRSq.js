import{q as se,N as ie,E as pe,w as ve,a as ce,h as fe,n as te,f as V,u as W,v as de,i as R,b as J,o as N,P as G,c as T,d as B,T as z}from"./CCXLNlmN.js";import{b as n,u as A,t as be,A as H,i as L,l as Pe,N as _,a as M}from"./CEsAfSXQ.js";import{f as E,j as Q,V as K,y as q,x as F,ab as X,G as I,F as U,z as le,ae as me,ac as Y}from"./BliPWy68.js";function ee(u,i){if(u)return u;let p=i??"button";if(typeof p=="string"&&p.toLowerCase()==="button")return"button"}function Se(u,i){let p=E(ee(u.value.type,u.value.as));return Q(()=>{p.value=ee(u.value.type,u.value.as)}),K(()=>{var w;p.value||n(i)&&n(i)instanceof HTMLButtonElement&&!((w=n(i))!=null&&w.hasAttribute("type"))&&(p.value="button")}),p}var ge=(u=>(u[u.Open=0]="Open",u[u.Closed=1]="Closed",u))(ge||{});let ne=Symbol("PopoverContext");function Z(u){let i=Y(ne,null);if(i===null){let p=new Error(`<${u} /> is missing a parent <${he.name} /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(p,Z),p}return i}let oe=Symbol("PopoverGroupContext");function ae(){return Y(oe,null)}let ue=Symbol("PopoverPanelContext");function ye(){return Y(ue,null)}let he=q({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(u,{slots:i,attrs:p,expose:w}){var g;let b=E(null);w({el:b,$el:b});let l=E(1),t=E(null),h=E(null),y=E(null),m=E(null),P=F(()=>R(b)),v=F(()=>{var e,a;if(!n(t)||!n(m))return!1;for(let D of document.querySelectorAll("body > *"))if(Number(D==null?void 0:D.contains(n(t)))^Number(D==null?void 0:D.contains(n(m))))return!0;let o=J(),d=o.indexOf(n(t)),C=(d+o.length-1)%o.length,O=(d+1)%o.length,j=o[C],re=o[O];return!((e=n(m))!=null&&e.contains(j))&&!((a=n(m))!=null&&a.contains(re))}),r={popoverState:l,buttonId:E(null),panelId:E(null),panel:m,button:t,isPortalled:v,beforePanelSentinel:h,afterPanelSentinel:y,togglePopover(){l.value=A(l.value,{0:1,1:0})},closePopover(){l.value!==1&&(l.value=1)},close(e){r.closePopover();let a=e?e instanceof HTMLElement?e:e.value instanceof HTMLElement?n(e):n(r.button):n(r.button);a==null||a.focus()}};X(ne,r),be(F(()=>A(l.value,{0:M.Open,1:M.Closed})));let $={buttonId:r.buttonId,panelId:r.panelId,close(){r.closePopover()}},S=ae(),k=S==null?void 0:S.registerPopover,[x,c]=se(),f=ie({mainTreeNodeRef:S==null?void 0:S.mainTreeNodeRef,portals:x,defaultContainers:[t,m]});function s(){var e,a,o,d;return(d=S==null?void 0:S.isFocusWithinPopoverGroup())!=null?d:((e=P.value)==null?void 0:e.activeElement)&&(((a=n(t))==null?void 0:a.contains(P.value.activeElement))||((o=n(m))==null?void 0:o.contains(P.value.activeElement)))}return K(()=>k==null?void 0:k($)),pe((g=P.value)==null?void 0:g.defaultView,"focus",e=>{var a,o;e.target!==window&&e.target instanceof HTMLElement&&l.value===0&&(s()||t&&m&&(f.contains(e.target)||(a=n(r.beforePanelSentinel))!=null&&a.contains(e.target)||(o=n(r.afterPanelSentinel))!=null&&o.contains(e.target)||r.closePopover()))},!0),ve(f.resolveContainers,(e,a)=>{var o;r.closePopover(),ce(a,fe.Loose)||(e.preventDefault(),(o=n(t))==null||o.focus())},F(()=>l.value===0)),()=>{let e={open:l.value===0,close:r.close};return I(U,[I(c,{},()=>H({theirProps:{...u,...p},ourProps:{ref:b},slot:e,slots:i,attrs:p,name:"Popover"})),I(f.MainTreeNode)])}}}),Fe=q({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(u,{attrs:i,slots:p,expose:w}){var g;let b=(g=u.id)!=null?g:`headlessui-popover-button-${L()}`,l=Z("PopoverButton"),t=F(()=>R(l.button));w({el:l.button,$el:l.button}),Q(()=>{l.buttonId.value=b}),le(()=>{l.buttonId.value=null});let h=ae(),y=h==null?void 0:h.closeOthers,m=ye(),P=F(()=>m===null?!1:m.value===l.panelId.value),v=E(null),r=`headlessui-focus-sentinel-${L()}`;P.value||K(()=>{l.button.value=n(v)});let $=Se(F(()=>({as:u.as,type:i.type})),v);function S(e){var a,o,d,C,O;if(P.value){if(l.popoverState.value===1)return;switch(e.key){case N.Space:case N.Enter:e.preventDefault(),(o=(a=e.target).click)==null||o.call(a),l.closePopover(),(d=n(l.button))==null||d.focus();break}}else switch(e.key){case N.Space:case N.Enter:e.preventDefault(),e.stopPropagation(),l.popoverState.value===1&&(y==null||y(l.buttonId.value)),l.togglePopover();break;case N.Escape:if(l.popoverState.value!==0)return y==null?void 0:y(l.buttonId.value);if(!n(l.button)||(C=t.value)!=null&&C.activeElement&&!((O=n(l.button))!=null&&O.contains(t.value.activeElement)))return;e.preventDefault(),e.stopPropagation(),l.closePopover();break}}function k(e){P.value||e.key===N.Space&&e.preventDefault()}function x(e){var a,o;u.disabled||(P.value?(l.closePopover(),(a=n(l.button))==null||a.focus()):(e.preventDefault(),e.stopPropagation(),l.popoverState.value===1&&(y==null||y(l.buttonId.value)),l.togglePopover(),(o=n(l.button))==null||o.focus()))}function c(e){e.preventDefault(),e.stopPropagation()}let f=te();function s(){let e=n(l.panel);if(!e)return;function a(){A(f.value,{[B.Forwards]:()=>G(e,T.First),[B.Backwards]:()=>G(e,T.Last)})===z.Error&&G(J().filter(o=>o.dataset.headlessuiFocusGuard!=="true"),A(f.value,{[B.Forwards]:T.Next,[B.Backwards]:T.Previous}),{relativeTo:n(l.button)})}a()}return()=>{let e=l.popoverState.value===0,a={open:e},{...o}=u,d=P.value?{ref:v,type:$.value,onKeydown:S,onClick:x}:{ref:v,id:b,type:$.value,"aria-expanded":l.popoverState.value===0,"aria-controls":n(l.panel)?l.panelId.value:void 0,disabled:u.disabled?!0:void 0,onKeydown:S,onKeyup:k,onClick:x,onMousedown:c};return I(U,[H({ourProps:d,theirProps:{...i,...o},slot:a,attrs:i,slots:p,name:"PopoverButton"}),e&&!P.value&&l.isPortalled.value&&I(V,{id:r,features:W.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:s})])}}}),Ie=q({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(u,{attrs:i,slots:p,expose:w}){var g;let b=(g=u.id)!=null?g:`headlessui-popover-panel-${L()}`,{focus:l}=u,t=Z("PopoverPanel"),h=F(()=>R(t.panel)),y=`headlessui-focus-sentinel-before-${L()}`,m=`headlessui-focus-sentinel-after-${L()}`;w({el:t.panel,$el:t.panel}),Q(()=>{t.panelId.value=b}),le(()=>{t.panelId.value=null}),X(ue,t.panelId),K(()=>{var c,f;if(!l||t.popoverState.value!==0||!t.panel)return;let s=(c=h.value)==null?void 0:c.activeElement;(f=n(t.panel))!=null&&f.contains(s)||G(n(t.panel),T.First)});let P=Pe(),v=F(()=>P!==null?(P.value&M.Open)===M.Open:t.popoverState.value===0);function r(c){var f,s;switch(c.key){case N.Escape:if(t.popoverState.value!==0||!n(t.panel)||h.value&&!((f=n(t.panel))!=null&&f.contains(h.value.activeElement)))return;c.preventDefault(),c.stopPropagation(),t.closePopover(),(s=n(t.button))==null||s.focus();break}}function $(c){var f,s,e,a,o;let d=c.relatedTarget;d&&n(t.panel)&&((f=n(t.panel))!=null&&f.contains(d)||(t.closePopover(),((e=(s=n(t.beforePanelSentinel))==null?void 0:s.contains)!=null&&e.call(s,d)||(o=(a=n(t.afterPanelSentinel))==null?void 0:a.contains)!=null&&o.call(a,d))&&d.focus({preventScroll:!0})))}let S=te();function k(){let c=n(t.panel);if(!c)return;function f(){A(S.value,{[B.Forwards]:()=>{var s;G(c,T.First)===z.Error&&((s=n(t.afterPanelSentinel))==null||s.focus())},[B.Backwards]:()=>{var s;(s=n(t.button))==null||s.focus({preventScroll:!0})}})}f()}function x(){let c=n(t.panel);if(!c)return;function f(){A(S.value,{[B.Forwards]:()=>{let s=n(t.button),e=n(t.panel);if(!s)return;let a=J(),o=a.indexOf(s),d=a.slice(0,o+1),C=[...a.slice(o+1),...d];for(let O of C.slice())if(O.dataset.headlessuiFocusGuard==="true"||e!=null&&e.contains(O)){let j=C.indexOf(O);j!==-1&&C.splice(j,1)}G(C,T.First,{sorted:!1})},[B.Backwards]:()=>{var s;G(c,T.Previous)===z.Error&&((s=n(t.button))==null||s.focus())}})}f()}return()=>{let c={open:t.popoverState.value===0,close:t.close},{focus:f,...s}=u,e={ref:t.panel,id:b,onKeydown:r,onFocusout:l&&t.popoverState.value===0?$:void 0,tabIndex:-1};return H({ourProps:e,theirProps:{...i,...s},attrs:i,slot:c,slots:{...p,default:(...a)=>{var o;return[I(U,[v.value&&t.isPortalled.value&&I(V,{id:y,ref:t.beforePanelSentinel,features:W.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:k}),(o=p.default)==null?void 0:o.call(p,...a),v.value&&t.isPortalled.value&&I(V,{id:m,ref:t.afterPanelSentinel,features:W.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:x})])]}},features:_.RenderStrategy|_.Static,visible:v.value,name:"PopoverPanel"})}}}),ke=q({name:"PopoverGroup",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(u,{attrs:i,slots:p,expose:w}){let g=E(null),b=me([]),l=F(()=>R(g)),t=de();w({el:g,$el:g});function h(v){let r=b.value.indexOf(v);r!==-1&&b.value.splice(r,1)}function y(v){return b.value.push(v),()=>{h(v)}}function m(){var v;let r=l.value;if(!r)return!1;let $=r.activeElement;return(v=n(g))!=null&&v.contains($)?!0:b.value.some(S=>{var k,x;return((k=r.getElementById(S.buttonId.value))==null?void 0:k.contains($))||((x=r.getElementById(S.panelId.value))==null?void 0:x.contains($))})}function P(v){for(let r of b.value)r.buttonId.value!==v&&r.close()}return X(oe,{registerPopover:y,unregisterPopover:h,isFocusWithinPopoverGroup:m,closeOthers:P,mainTreeNodeRef:t.mainTreeNodeRef}),()=>I(U,[H({ourProps:{ref:g},theirProps:{...u,...i},slot:{},attrs:i,slots:p,name:"PopoverGroup"}),I(t.MainTreeNode)])}});export{ke as A,Fe as G,Ie as j,Se as s,he as y};
